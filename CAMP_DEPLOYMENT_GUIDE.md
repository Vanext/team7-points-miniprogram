# 训练营云函数部署指南

## 🚨 问题分析

你遇到的错误 `ResourceNotFound.Function` 表明云函数尚未在云开发环境中创建。虽然代码和配置文件都已准备就绪，但需要通过微信开发者工具手动部署。

## 📋 部署步骤

### 1. 打开微信开发者工具
- 启动微信开发者工具
- 打开你的 Team 7 小程序项目

### 2. 进入云开发控制台
- 点击顶部菜单栏的「云开发」
- 选择「云函数」标签页

### 3. 部署训练营云函数
你需要手动部署以下4个云函数：

#### 📁 getCampData
1. 在云函数列表中找到 `getCampData`
2. 右键点击函数名
3. 选择「上传并部署：云端安装依赖」
4. 等待部署完成（状态显示为绿色）

#### 📁 getCampLeaderboard  
1. 在云函数列表中找到 `getCampLeaderboard`
2. 右键点击函数名
3. 选择「上传并部署：云端安装依赖」
4. 等待部署完成

#### 📁 initCampData
1. 在云函数列表中找到 `initCampData`
2. 右键点击函数名  
3. 选择「上传并部署：云端安装依赖」
4. 等待部署完成

#### 📁 submitPoints（更新版本）
1. 在云函数列表中找到 `submitPoints`
2. 右键点击函数名
3. 选择「上传并部署：云端安装依赖」
4. 等待部署完成

### 4. 验证部署
部署完成后，你可以：

#### 测试 getCampData
在云函数控制台中：
1. 点击 `getCampData` 函数
2. 选择「测试」标签
3. 输入测试参数：
```json
{
  "camp_id": "ironman703_2024"
}
```
4. 点击「运行测试」

#### 测试 initCampData
1. 点击 `initCampData` 函数
2. 选择「测试」标签  
3. 输入测试参数：
```json
{
  "action": "init_camp_data"
}
```
4. 点击「运行测试」

### 5. 初始化训练营数据
部署成功后，首先需要运行 `initCampData` 来创建训练营数据：

1. 在云函数控制台测试 `initCampData`
2. 或使用小程序代码调用：
```javascript
wx.cloud.callFunction({
  name: 'initCampData',
  data: {
    action: 'init_camp_data'
  }
})
```

## 🔧 常见问题解决

### 问题1：部署失败
**解决方案：**
- 确保已安装依赖：`npm install`
- 检查云开发环境是否开通
- 确认云函数配额未满

### 问题2：函数不存在
**解决方案：**
- 重新创建云函数文件夹
- 确保 `package.json` 文件存在
- 检查 `cloudbaserc.json` 配置

### 问题3：权限错误
**解决方案：**
- 检查数据库权限设置
- 确保云函数有正确的环境变量

## ✅ 部署验证清单

部署完成后，请确认：
- [ ] 所有4个云函数状态为「部署成功」
- [ ] `initCampData` 可以成功创建训练营数据
- [ ] `getCampData` 可以正确返回训练营信息
- [ ] `getCampLeaderboard` 可以生成排行榜
- [ ] `submitPoints` 支持训练营模式上传

## 📱 小程序端测试

部署完成后，在小程序中测试：
1. 进入训练营首页
2. 查看训练计划
3. 尝试上传训练记录
4. 查看排行榜

如果遇到任何问题，请检查云开发控制台中的日志和错误信息。