<view class="container">
  <block wx:if="{{!isAdmin}}">
    <view class="no-access-card">
      <view class="no-access-icon">ğŸ”’</view>
      <view class="no-access-title">æƒé™ä¸è¶³</view>
      <view class="no-access-desc">åªæœ‰ç®¡ç†å‘˜æ‰èƒ½è®¿é—®æ­¤é¡µé¢</view>
    </view>
  </block>
  <block wx:else>
    <!-- Header & Tabs -->
    <view class="page-header">
      <view class="header-title">
        <text>è®­ç»ƒè¥ç”³è¯·</text>
        <view class="count-badge" wx:if="{{list.length > 0}}">{{list.length}}</view>
      </view>
      <view class="tabs">
        <view class="tab-item {{currentTab==='pending'?'active':''}}" bindtap="onTabChange" data-id="pending">å¾…å®¡æ ¸</view>
        <view class="tab-item {{currentTab==='approved'?'active':''}}" bindtap="onTabChange" data-id="approved">å·²é€šè¿‡</view>
        <view class="tab-item {{currentTab==='rejected'?'active':''}}" bindtap="onTabChange" data-id="rejected">å·²æ‹’ç»</view>
      </view>
    </view>

    <!-- Content List -->
    <scroll-view scroll-y class="content-scroll">
      <view class="list-container">
        <block wx:for="{{list}}" wx:key="_id">
          <view class="app-card">
            <view class="card-main">
              <view class="user-info">
                <view class="name-row">
                  <text class="user-name">{{item.nickName || 'å¾®ä¿¡ç”¨æˆ·'}}</text>
                  <view class="status-tag {{item.status}}">
                    {{item.status === 'pending' ? 'å¾…å®¡æ ¸' : (item.status==='approved' ? 'å·²é€šè¿‡' : 'å·²æ‹’ç»')}}
                  </view>
                </view>
                <view class="time-row">
                  <text class="label">ç”³è¯·æ—¶é—´ï¼š</text>
                  <text class="value">{{item.applyTimeText}}</text>
                </view>
              </view>
            </view>
            
            <view class="card-actions">
              <block wx:if="{{currentTab==='pending'}}">
                <view class="action-btn approve" data-id="{{item._id}}" bindtap="approve">é€šè¿‡</view>
                <view class="action-btn reject" data-id="{{item._id}}" bindtap="reject">æ‹’ç»</view>
              </block>
              <block wx:if="{{currentTab==='approved'}}">
                <view class="action-btn revoke" data-id="{{item._id}}" bindtap="cancelApproved">å–æ¶ˆé€šè¿‡</view>
              </block>
              <block wx:if="{{currentTab==='rejected'}}">
                <view class="action-btn disabled">å·²æ‹’ç»</view>
              </block>
            </view>
          </view>
        </block>
        
        <view wx:if="{{list.length === 0}}" class="empty-tip">
          <text>æš‚æ— {{currentTab === 'pending' ? 'å¾…å®¡æ ¸' : (currentTab === 'approved' ? 'å·²é€šè¿‡' : 'å·²æ‹’ç»')}}ç”³è¯·</text>
        </view>
      </view>
    </scroll-view>
  </block>
</view>
