<!--pages/upload/upload.wxml-->
<view class="container">
  <view class="header-actions">
    <view class="rules-btn" bindtap="showRules">
      <text class="icon">ℹ️</text>
      <text>积分和使用规则</text>
    </view>
  </view>

  <!-- Custom Tab Bar -->
  <view class="tabs">
    <view class="tab-item {{currentTab === 0 ? 'active' : ''}}" bindtap="switchTab" data-index="0">参加比赛</view>
    <view class="tab-item {{currentTab === 1 ? 'active' : ''}}" bindtap="switchTab" data-index="1">参加活动</view>
    <view class="tab-item {{currentTab === 2 ? 'active' : ''}}" bindtap="switchTab" data-index="2">周训练打卡</view>
    <view class="tab-item {{currentTab === 3 ? 'active' : ''}}" bindtap="switchTab" data-index="3">俱乐部建设</view>
  </view>

  <!-- Content Area -->
  <view class="content-area">
    
    <!-- Tab 0: 参加比赛 -->
    <view class="form-section" wx:if="{{currentTab === 0}}">
      <view class="form-group">
        <label>日期</label>
        <picker mode="date" value="{{date}}" bindchange="bindDateChange">
          <view class="picker-view">{{date}}</view>
        </picker>
      </view>
      <view class="form-group">
        <label>比赛类型</label>
        <picker mode="selector" range="{{matchTypes}}" bindchange="bindMatchTypeChange">
          <view class="picker-view">{{selectedMatchType || '请选择比赛类型'}}</view>
        </picker>
      </view>
      <view class="form-group switch-group">
        <label>是否站台前三</label>
        <switch checked="{{isPodium}}" bindchange="bindPodiumChange" color="#1a237e"/>
      </view>
      <view class="form-group">
        <label>描述</label>
        <textarea placeholder="请输入详细描述..." bindinput="bindDescriptionInput" value="{{description}}"></textarea>
      </view>
      <view class="form-group">
        <label>上传图片</label>
        <view class="image-uploader" bindtap="chooseImage">
          <image wx:if="{{imageUrl}}" src="{{imageUrl}}" mode="aspectFill"></image>
          <view wx:else class="upload-placeholder">+</view>
        </view>
      </view>
    </view>

    <!-- Tab 1: 参加活动 -->
    <view class="form-section" wx:if="{{currentTab === 1}}">
      <view class="form-group">
        <label>日期</label>
        <picker mode="date" value="{{date}}" bindchange="bindDateChange">
          <view class="picker-view">{{date}}</view>
        </picker>
      </view>
      <view class="form-group">
        <label>活动类型</label>
        <picker mode="selector" range="{{activityTypes}}" bindchange="bindActivityTypeChange">
          <view class="picker-view">{{selectedActivityType || '请选择活动类型'}}</view>
        </picker>
      </view>
      <view class="form-group">
        <label>描述</label>
        <textarea placeholder="请输入详细描述..." bindinput="bindDescriptionInput" value="{{description}}"></textarea>
      </view>
      <view class="form-group">
        <label>上传图片</label>
        <view class="image-uploader" bindtap="chooseImage">
          <image wx:if="{{imageUrl}}" src="{{imageUrl}}" mode="aspectFill"></image>
          <view wx:else class="upload-placeholder">+</view>
        </view>
      </view>
    </view>

    <!-- Tab 2: 周训练打卡 -->
    <view class="form-section" wx:if="{{currentTab === 2}}">
      <view class="form-group">
        <label>日期</label>
        <picker mode="date" value="{{date}}" bindchange="bindDateChange">
          <view class="picker-view">{{date}}</view>
        </picker>
      </view>
      <view class="form-group">
        <label>训练时长 (小时)</label>
        <view class="hours-grid">
          <view 
            class="hour-item {{selectedHours === item ? 'selected' : ''}}" 
            wx:for="{{hoursList}}" 
            wx:key="*this"
            bindtap="selectHours"
            data-hours="{{item}}"
          >
            {{item}}
          </view>
        </view>
      </view>
      <view class="form-group">
        <label>描述</label>
        <textarea placeholder="请输入详细描述..." bindinput="bindDescriptionInput" value="{{description}}"></textarea>
      </view>
      <view class="form-group">
        <label>上传图片</label>
        <view class="image-uploader" bindtap="chooseImage">
          <image wx:if="{{imageUrl}}" src="{{imageUrl}}" mode="aspectFill"></image>
          <view wx:else class="upload-placeholder">+</view>
        </view>
      </view>
    </view>

    <!-- Tab 3: 俱乐部建设 -->
    <view class="form-section" wx:if="{{currentTab === 3}}">
      <view class="form-group">
        <label>日期</label>
        <picker mode="date" value="{{date}}" bindchange="bindDateChange">
          <view class="picker-view">{{date}}</view>
        </picker>
      </view>
      <view class="form-group">
        <label>建设类型</label>
        <picker mode="selector" range="{{constructionTypes}}" bindchange="bindConstructionTypeChange">
          <view class="picker-view">{{selectedConstructionType || '请选择建设类型'}}</view>
        </picker>
      </view>
      <view class="form-group">
        <label>描述</label>
        <textarea placeholder="请输入详细描述..." bindinput="bindDescriptionInput" value="{{description}}"></textarea>
      </view>
      <view class="form-group">
        <label>上传图片</label>
        <view class="image-uploader" bindtap="chooseImage">
          <image wx:if="{{imageUrl}}" src="{{imageUrl}}" mode="aspectFill"></image>
          <view wx:else class="upload-placeholder">+</view>
        </view>
      </view>
    </view>

    <button class="submit-btn" bindtap="submitForm">提交</button>
  </view>

  <!-- Rules Modal -->
  <view class="modal" wx:if="{{showRulesModal}}">
    <view class="modal-mask" bindtap="hideRules"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text>积分和使用规则</text>
        <view class="close-icon" bindtap="hideRules">×</view>
      </view>
      <scroll-view scroll-y class="modal-body">
        <view class="rule-section">
          <text class="rule-title">比赛类别:</text>
          <text class="rule-item">- 大铁: 1200分</text>
          <text class="rule-item">- 70.3: 600分</text>
          <text class="rule-item">- 标铁: 300分</text>
          <text class="rule-item">- 半程马拉松: 300分</text>
          <text class="rule-item">- 远距赛事 (半程以上): 100分</text>
          <text class="rule-item">- 站台前三: +200分</text>
        </view>
        <view class="rule-section">
          <text class="rule-title">活动类别:</text>
          <text class="rule-item">- 分享会等大型俱乐部集体活动: 150分</text>
          <text class="rule-item">- 团练活动: 20分</text>
        </view>
        <view class="rule-section">
          <text class="rule-title">训练类别:</text>
          <text class="rule-item">- 训练每小时: 2分 (每周40分封顶)</text>
        </view>
        <view class="rule-section">
          <text class="rule-title">俱乐部建设:</text>
          <text class="rule-item">- 公众号投稿: 200分</text>
          <text class="rule-item">- 拓展新会员 (新会员合籍): 200分</text>
        </view>
        <view class="rule-section">
          <text class="rule-title">积分使用:</text>
          <text class="rule-item">同会员规则，每年需需参考可激活</text>
          <text class="rule-item">兑换商品价格为兑换积分额 (1元=1分)</text>
          <text class="rule-item">积分可在商城兑换俱乐部周边商品</text>
        </view>
        <view class="rule-section">
          <text class="rule-title">【有效训练】</text>
          <text class="rule-item">指带有实际训练意义的，如跑步、骑车、游泳、力量等并满足强度要求的训练 (排除恢复跑、拉练、通勤骑)</text>
        </view>
      </scroll-view>
      <view class="modal-footer">
        <button class="confirm-btn" bindtap="hideRules">确定</button>
      </view>
    </view>
  </view>
</view>