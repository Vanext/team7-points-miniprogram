<!--pages/edit-profile/edit-profile.wxml-->
<view class="container">
  <!-- 基本信息卡片 -->
  <view class="form-card">
    <view class="card-title">基本信息</view>
    
    <!-- 头像 -->
    <view class="form-item avatar-item" bindtap="onAvatarTap">
      <text class="label">头像</text>
      <view class="content">
        <image class="avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
        <text class="arrow">></text>
      </view>
    </view>

    <!-- 昵称 -->
    <view class="form-item">
      <text class="label">昵称</text>
      <input class="input" 
             value="{{userInfo.nickName}}" 
             placeholder="请输入昵称" 
             bindinput="onNicknameInput"
             maxlength="20"/>
    </view>
  </view>

  <!-- 账户信息卡片 -->
  <view class="form-card">
    <view class="card-title">账户信息</view>
    
    <view class="form-item">
      <text class="label">当前积分</text>
      <text class="value highlight">{{dbUserInfo.totalPoints || 0}}</text>
    </view>
    
    <view class="form-item" wx:if="{{dbUserInfo.formattedJoinDate}}">
      <text class="label">加入时间</text>
      <text class="value">{{dbUserInfo.formattedJoinDate}}</text>
    </view>
    
    <view class="form-item" wx:if="{{dbUserInfo.isAdmin}}">
      <text class="label">身份</text>
      <view class="badge-admin">管理员</view>
    </view>
  </view>

  <view class="tips">
    <text>提示：点击头像可更换，昵称建议使用真实姓名以便管理员识别。</text>
  </view>

  <!-- 底部按钮区 -->
  <view class="footer-bar">
    <button class="btn btn-secondary" bindtap="goBack">取消</button>
    <button class="btn btn-primary" bindtap="saveProfile" loading="{{saving}}">保存修改</button>
  </view>
</view>
